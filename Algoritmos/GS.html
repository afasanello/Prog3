<!DOCTYPE html>
<html lang="es">
  <head>
    <title>Algoritmo Gale-Shapley</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link href="css/code.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style type="text/css">
      #network_0 {
        width: 100%;
        height: 700px;
      }
    </style>
  </head>
  <body>
    <div class="content m-4">
        <div class="row">
            <div class="col">
                <h2>Algoritmo Gale-Shapley</h2>
                <div class="row">
                    <div class="col-4">
                        <button class="btn btn-primary m-2 col-12" onclick="start()">Iniciar algoritmo</button>
                    </div>
                    <div class="col-4">
                        <button class="btn btn-primary m-2 col-12" onclick="stop()">Pausa</button>
                    </div>
                    <div class="col-4">
                        <button class="btn btn-primary m-2 col-12" onclick="nextStep()">Avanzar un paso</button>
                    </div>
                </div>
                
                
                
                

            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div id="network_0"></div>
            </div>
            <div class="col-9">
                <div class="row">
                    <div class="col">
                        <div id="internal">
                            <div class="row">
                                <div class="col-6">
                                    <h3>Pref. proponentes:</h3>
                                    <span style="font-size: 12px;">Listas que almacenan a los propuestos por orden de preferencia de los proponentes.</span>
                                    <div class="table-responsive">
                                        <table class="table table-light table-bordered table-sm align-middle text-center">
                                            <tbody>
                                                <tr>
                                                    <th>M1</th>
                                                    <td style="width: 16.7%" class="proponent" id="proponent_1_0"></td>
                                                    <td style="width: 16.7%" class="proponent" id="proponent_1_1"></td>
                                                    <td style="width: 16.7%" class="proponent" id="proponent_1_2"></td>
                                                    <td style="width: 16.7%" class="proponent" id="proponent_1_3"></td>
                                                    <td style="width: 16.7%" class="proponent" id="proponent_1_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>M2</th>
                                                    <td class="proponent" id="proponent_2_0"></td>
                                                    <td class="proponent" id="proponent_2_1"></td>
                                                    <td class="proponent" id="proponent_2_2"></td>
                                                    <td class="proponent" id="proponent_2_3"></td>
                                                    <td class="proponent" id="proponent_2_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>M3</th>
                                                    <td class="proponent" id="proponent_3_0"></td>
                                                    <td class="proponent" id="proponent_3_1"></td>
                                                    <td class="proponent" id="proponent_3_2"></td>
                                                    <td class="proponent" id="proponent_3_3"></td>
                                                    <td class="proponent" id="proponent_3_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>M4</th>
                                                    <td class="proponent" id="proponent_4_0"></td>
                                                    <td class="proponent" id="proponent_4_1"></td>
                                                    <td class="proponent" id="proponent_4_2"></td>
                                                    <td class="proponent" id="proponent_4_3"></td>
                                                    <td class="proponent" id="proponent_4_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>M5</th>
                                                    <td class="proponent" id="proponent_5_0"></td>
                                                    <td class="proponent" id="proponent_5_1"></td>
                                                    <td class="proponent" id="proponent_5_2"></td>
                                                    <td class="proponent" id="proponent_5_3"></td>
                                                    <td class="proponent" id="proponent_5_4"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <h3>Pref. propuestos:</h3>
                                    <span style="font-size: 12px;">Listas que almacenan a los proponentes por orden de preferencia de los propuestos.</span>
                                    <div class="table-responsive">
                                        <table class="table table-light table-bordered table-sm align-middle text-center">
                                            <tbody>
                                                <tr>
                                                    <th>W1</th>
                                                    <td style="width: 16.7%" class="proposed" id="proposed_1_0"></td>
                                                    <td style="width: 16.7%" class="proposed" id="proposed_1_1"></td>
                                                    <td style="width: 16.7%" class="proposed" id="proposed_1_2"></td>
                                                    <td style="width: 16.7%" class="proposed" id="proposed_1_3"></td>
                                                    <td style="width: 16.7%" class="proposed" id="proposed_1_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W2</th>
                                                    <td class="proposed" id="proposed_2_0"></td>
                                                    <td class="proposed" id="proposed_2_1"></td>
                                                    <td class="proposed" id="proposed_2_2"></td>
                                                    <td class="proposed" id="proposed_2_3"></td>
                                                    <td class="proposed" id="proposed_2_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W3</th>
                                                    <td class="proposed" id="proposed_3_0"></td>
                                                    <td class="proposed" id="proposed_3_1"></td>
                                                    <td class="proposed" id="proposed_3_2"></td>
                                                    <td class="proposed" id="proposed_3_3"></td>
                                                    <td class="proposed" id="proposed_3_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W4</th>
                                                    <td class="proposed" id="proposed_4_0"></td>
                                                    <td class="proposed" id="proposed_4_1"></td>
                                                    <td class="proposed" id="proposed_4_2"></td>
                                                    <td class="proposed" id="proposed_4_3"></td>
                                                    <td class="proposed" id="proposed_4_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W5</th>
                                                    <td class="proposed" id="proposed_5_0"></td>
                                                    <td class="proposed" id="proposed_5_1"></td>
                                                    <td class="proposed" id="proposed_5_2"></td>
                                                    <td class="proposed" id="proposed_5_3"></td>
                                                    <td class="proposed" id="proposed_5_4"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <br />
                            <div class="row">
                                <div class="col-6">
                                    <h3>Proponentes libres:</h3>
                                    <span style="font-size: 12px;">Lista enlazada que almacena los proponentes que no están emparejados con ningún propuesto.</span>
                                    <div class="table-responsive">
                                        <table class="table table-light table-bordered table-sm align-middle text-center">
                                            <tbody>
                                                <tr>
                                                    <th>MLibres</th>
                                                    <td class="mfree" id="mfree_0" style="width: 16.7%"></td>
                                                    <td class="mfree" id="mfree_1" style="width: 16.7%"></td>
                                                    <td class="mfree" id="mfree_2" style="width: 16.7%"></td>                                            
                                                    <td class="mfree" id="mfree_3" style="width: 16.7%"></td>
                                                    <td class="mfree" id="mfree_4" style="width: 16.7%"></td>
                                                </tr>
                                                <tr>
                                                    <th>M</th>
                                                    <td class="man"></td>
                                                    <td colspan="4"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
        
                                    <br />
                                    <h3>Siguiente propuesto:</h3>
                                    <span style="font-size: 12px;">Almacena el índice del siguiente propuesto para cada proponente.</span>
                                    <div class="table-responsive">
                                        <table class="table table-light table-bordered table-sm align-middle text-center">
                                            <tbody>
                                                <tr>
                                                    <th></th>
                                                    <th>M1</th>
                                                    <th>M2</th>
                                                    <th>M3</th>
                                                    <th>M4</th>
                                                    <th>M5</th>
                                                <tr>
                                                    <th>Siguiente[M]</th>
                                                    <td class="next" style="width: 16.7%"></td>
                                                    <td class="next" style="width: 16.7%"></td>
                                                    <td class="next" style="width: 16.7%"></td>                                            
                                                    <td class="next" style="width: 16.7%"></td>
                                                    <td class="next" style="width: 16.7%"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <h3>Ranking:</h3>
                                    <span style="font-size: 12px;">Matriz que almacena la posición del proponente en el ranking del propuesto.</span>
                                    <div class="table-responsive">
                                        <table class="table table-light table-bordered table-sm align-middle text-center">
                                            <tbody>
                                                <tr>
                                                    <th></th>
                                                    <th>M1</th>
                                                    <th>M2</th>
                                                    <th>M3</th>
                                                    <th>M4</th>
                                                    <th>M5</th>
                                                </tr>
                                                <tr>
                                                    <th>W1</th>
                                                    <td style="width: 16.7%" class="ranking" id="ranking_1_0"></td>
                                                    <td style="width: 16.7%" class="ranking" id="ranking_1_1"></td>
                                                    <td style="width: 16.7%" class="ranking" id="ranking_1_2"></td>
                                                    <td style="width: 16.7%" class="ranking" id="ranking_1_3"></td>
                                                    <td style="width: 16.7%" class="ranking" id="ranking_1_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W2</th>
                                                    <td class="ranking" id="ranking_2_0"></td>
                                                    <td class="ranking" id="ranking_2_1"></td>
                                                    <td class="ranking" id="ranking_2_2"></td>
                                                    <td class="ranking" id="ranking_2_3"></td>
                                                    <td class="ranking" id="ranking_2_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W3</th>
                                                    <td class="ranking" id="ranking_3_0"></td>
                                                    <td class="ranking" id="ranking_3_1"></td>
                                                    <td class="ranking" id="ranking_3_2"></td>
                                                    <td class="ranking" id="ranking_3_3"></td>
                                                    <td class="ranking" id="ranking_3_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W4</th>
                                                    <td class="ranking" id="ranking_4_0"></td>
                                                    <td class="ranking" id="ranking_4_1"></td>
                                                    <td class="ranking" id="ranking_4_2"></td>
                                                    <td class="ranking" id="ranking_4_3"></td>
                                                    <td class="ranking" id="ranking_4_4"></td>
                                                </tr>
                                                <tr>
                                                    <th>W5</th>
                                                    <td class="ranking" id="ranking_5_0"></td>
                                                    <td class="ranking" id="ranking_5_1"></td>
                                                    <td class="ranking" id="ranking_5_2"></td>
                                                    <td class="ranking" id="ranking_5_3"></td>
                                                    <td class="ranking" id="ranking_5_4"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <br />
                            <h3>Pareja actual:</h3>
                            <span style="font-size: 12px;">Almacena la pareja de cada propuesto.</span>
                            <div class="table-responsive">
                                <table class="table table-light table-bordered table-sm align-middle text-center">
                                    <tbody>
                                        <tr>
                                            <th></th>
                                            <th>W1</th>
                                            <th>W2</th>
                                            <th>W3</th>
                                            <th>W4</th>
                                            <th>W5</th>
                                        <tr>
                                            <th>Actual[W]</th>
                                            <td class="current" style="width: 16.7%"></td>
                                            <td class="current" style="width: 16.7%"></td>
                                            <td class="current" style="width: 16.7%"></td>                                            
                                            <td class="current" style="width: 16.7%"></td>
                                            <td class="current" style="width: 16.7%"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                    <div class="col">
                        <div id="source">
                            <h3>Pseudocódigo: Gale-Shapley</h3>
                            <div id="code">
                                <div class="line"></div>
                                <div class="line"><pre><code><span class="header">Emparejamiento</span> <span class="name">GS</span><span class="brackets">(</span><span class="header">W</span> <span class="parameter">**prefM</span>, <span class="header">M</span> <span class="parameter">**prefW</span><span class="brackets">) {</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="comment">// La implementación acepta cualquier lista; usaremos una cola</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="parameter">mLibres</span> = <span class="name">crearCola</span><span class="brackets">()</span>;</code></pre></div>
                                <div class="line"></div>
                                <div class="line"><pre><code>    <span class="comment">// Inicialmente todos los proponentes y propuestos se encuentran libres</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="loop">for</span><span class="brackets">(</span><span class="parameter">w</span> <span class="loop">in</span> <span class="parameter">W</span><span class="brackets">) {</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="parameter">actual</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">]</span> = <span class="header">NULL</span>;</code></pre></div>
                                <div class="line"><pre><code>    <span class="brackets">}</span></code></pre></div>
                                <div class="line"></div>
                                <div class="line"><pre><code>    <span class="comment">// Inicializamos los arreglos y las listas</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="loop">for</span><span class="brackets">(</span><span class="parameter">m</span> <span class="loop">in</span> <span class="parameter">M</span><span class="brackets">) {</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="name">encolar</span><span class="brackets">(</span><span class="parameter">mLibres</span>, <span class="parameter">m</span><span class="brackets">)</span>;</code></pre></div>
                                <div class="line"><pre><code>        <span class="parameter">siguiente</span><span class="brackets">[</span><span class="parameter">m</span><span class="brackets">]</span> = <span class="name">0</span>;</code></pre></div>
                                
                                <div class="line"><pre><code>        <span class="loop">for</span><span class="brackets">(</span><span class="parameter">w</span> <span class="loop">in</span> <span class="parameter">W</span><span class="brackets">) {</span></code></pre></div>
                                <div class="line"><pre><code>            <span class="parameter">ranking</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">][</span><span class="parameter">prefW</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">][</span><span class="parameter">m</span><span class="brackets">]</span><span class="brackets">]</span> = <span class="parameter">m</span>;</code></pre></div>
                                <div class="line"><pre><code>        <span class="brackets">}</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="brackets">}</span></code></pre></div>
                                <div class="line"></div>
                                <div class="line"><pre><code>    <span class="comment">// Mientras haya un proponente libre que no se haya propuesto a todos</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="loop">while</span><span class="brackets">(</span>!<span class="name">esVacia</span><span class="brackets">(</span><span class="parameter">mLibres</span><span class="brackets">)) {</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="comment">// Elegimos ese proponente</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="parameter">m</span> = <span class="name">desencolar</span><span class="brackets">(</span><span class="parameter">mLibres</span><span class="brackets">)</span>;</code></pre></div>
                                <div class="line"><pre><code>        <span class="comment">// Sea w el propuesto mejor rankeado al que m aún no propuso</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="parameter">w</span> = <span class="parameter">prefM</span><span class="brackets">[</span><span class="parameter">m</span><span class="brackets">][</span><span class="parameter">siguiente</span><span class="brackets">[</span><span class="parameter">m</span><span class="brackets">]]</span>;</code></pre></div>
                                <div class="line"><pre><code>        <span class="parameter">siguiente</span><span class="brackets">[</span><span class="parameter">m</span><span class="brackets">]</span>++;</code></pre></div>
                                <div class="line"></div>
                                <div class="line"><pre><code>        <span class="loop">if</span><span class="brackets">(</span><span class="parameter">actual</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">]</span> == <span class="header">NULL</span><span class="brackets">) {</span>  <span class="comment">// Si w está libre</span></code></pre></div>
                                <div class="line"><pre><code>            <span class="parameter">actual</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">]</span> = <span class="parameter">m</span>;  <span class="comment">// (m, w) se emparejan</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="brackets">}</span> <span class="loop">else</span> <span class="brackets">{</span>  <span class="comment">// w está emparejado con m'</span></code></pre></div>
                                <div class="line"><pre><code>            <span class="parameter">m'</span> = <span class="parameter">actual</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">]</span>;</code></pre></div>
                                <div class="line"><pre><code>            <span class="loop">if</span><span class="brackets">(</span><span class="parameter">ranking</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">][</span><span class="parameter">m</span><span class="brackets">]</span> &gt; <span class="parameter">ranking</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">][</span><span class="parameter">m'</span><span class="brackets">]) {</span>  <span class="comment">// Si w prefiere a su pareja actual</span></code></pre></div>
                                <div class="line"><pre><code>                <span class="name">encolar</span><span class="brackets">(</span><span class="parameter">mLibres</span>, <span class="parameter">m</span><span class="brackets">)</span>;  <span class="comment">// m permanece libre</span></code></pre></div>
                                <div class="line"><pre><code>            <span class="brackets">} <span class="loop">else</span> <span class="brackets">{</span>  <span class="comment">// Si w prefiere a la nueva pareja</span></span></code></pre></div>
                                <div class="line"><pre><code>                <span class="name">encolar</span><span class="brackets">(</span><span class="parameter">mLibres</span>, <span class="parameter">m'</span><span class="brackets">)</span>;  <span class="comment">// (m', w) se separan</span></code></pre></div>
                                <div class="line"><pre><code>                <span class="parameter">actual</span><span class="brackets">[</span><span class="parameter">w</span><span class="brackets">]</span> = <span class="parameter">m</span>;  <span class="comment">// (m, w) se emparejan</span></code></pre></div>
                                <div class="line"><pre><code>            <span class="brackets">}</span></code></pre></div>
                                <div class="line"><pre><code>        <span class="brackets">}</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="brackets">}</span></code></pre></div>
                                <div class="line"></div>
                                <div class="line"><pre><code>    <span class="comment">// Se retorna el conjunto de parejas</span></code></pre></div>
                                <div class="line"><pre><code>    <span class="name">eliminarCola</span><span class="brackets">(</span><span class="parameter">mLibres</span><span class="brackets">)</span>;</code></pre></div>
                                <div class="line"><pre><code>    <span class="loop">return</span> <span class="parameter">actual</span>;</code></pre></div>
                                <div class="line"><pre><code><span class="brackets">}</span></code></pre></div>
                                <div class="line"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/GS.js" type="text/javascript"></script>
  </body>
</html>